<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>PieChart Demo</title>
    <script src="../lib/Class.js"></script>
    <script src="../lib/jquery-2.0.3.js"></script>
    <script src="../src/zChart.js"></script>
    <script src="../src/util/util.js"></script>
    <script src="../src/util/const.js"></script>
    <script src="../src/title/Title.js"></script>
    <script src="../src/legend/Legend.js"></script>
    <script src="../src/tip/Tip.js"></script>
    <script src="../src/chart/Chart.js"></script>
    <script src="../src/chart/PieChart.js"></script>
    <script>
        var chart;
        $(function() {
            var data1 = [];
            var data2 = {};
            var brands = ["iPhone 5", "Galaxy 4", "HTC one", "Galaxy III", "iPhone 4s", "All Brands"];
            var areas = ["Europa", "Asia", "America", "Africa", "Latin America"];
            var sum, value, brand;
            for (var i = 0; i < brands.length; i++) {
                brand = brands[i];
                sum = 0;
                data2[brand] = [];

                for (var j = 0; j < areas.length; j++) {
                    value = Math.round(Math.random() * 300 + 100);
                    data2[brand].push({
                        text: areas[j],
                        value: value
                    });
                    sum += value;
                }

                if (i < brands.length - 1) {
                    data1.push({
                        text: brand,
                        value: sum
                    });
                }
            }

            // pie 1
            var chart1 = zChart.create({
                chart: {
                    type: "pie",
                    container: "chart-1",
                    width: 400,
                    height: 300
                },
                title: {
                    mainTitle: {
                        text: "2012 Smart-phone Market Share Top-5",
                        height: 30
                    },
                    subTitle: {
                        text: "-- simulate & random data",
                        height: 20
                    }
                },
                legend: {
                    place: "left",
                    width: 120
                },
                pie: {
                    unit: "M"
                }
            });

            chart = chart1;
            chart1.render();
            chart1.setData(data1);
            chart1.addListener("click", function (event, data) {
                var brand = data.text;
                if (data.expanded === false) {
                    brand = "All Brands"
                }

                var text = brand + " -- Area Market Share";
                chart2.setTitle({mainTitle: {text: text}});
                chart2.setData(data2[brand]);
            });

            // pie 2
            var option2 = {
                chart: {
                    type: "pie",
                    width: 400,
                    height: 300
                },
                title: {
                    enabled: true,
                    mainTitle: {
                        text: "All Brands -- Area Market Share",
                        height: 50
                    }
                },
                legend: {
                    place: "right",
                    width: 120
                },
                pie: {
                    unit: "M"
                }
            };

            var chart2 = zChart.create(option2);
            chart2.render("chart-2");
            chart2.setData(data2["iPhone 5"]);

            // customize pie 1
        });
    </script>
    <style>
        body {
            font-family: Tahoma,arial,sans-serif;
            font-size: 12px;
        }
        .charts {
            display: block;
            position: relative;
        }
        .charts > div {
            float: left;
            background-color: #E1E2E3;
            margin-right: 5px;
        }

        .custom {
            display: block;
            clear: left;
            padding-top: 10px;
        }
        .custom * {
            display: block;
        }
        .custom h1 {
            font-size: 14px;
        }

        .option * {
            float: left;
        }
        .option > label {
            height: 25px;
            line-height: 25px;
        }
        .option > label:first-child {
            min-width: 30px;
            padding-right: 3px;
            padding-left: 10px;
            text-align: right;
        }
        .title {
            width: 50px;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="charts">
    <div id="chart-1"></div>
    <div id="chart-2"></div>
</div>
<div class="custom">
    <h1>Customize left Pie Chart</h1>
    <div class="option">
        <label class="title">Options</label>
    </div>
    <div class="option">
        <label>Depth</label>
        <input name="depth" target="option.pie" type="number" min="0" max="10" value="0" datatype="number">
        <label>px</label>
    </div>
    <div class="option">
        <label>Tilt</label>
        <input name="tilt" target="option.pie" type="number" min="0" max="100" value="0" datatype="number" factor="0.01">
        <label>%</label>
    </div>
    <div class="option">
        <label>Expand Offset</label>
        <input name="expandOffset" target="option.pie" type="number" min="10" max="30" value="10" datatype="number">
        <label>px</label>
    </div>
    <div class="option">
        <label>Label Radius</label>
        <input name="radius" target="option.pie.label" type="number" min="-30" max="30" value="-30" datatype="number">
        <label>px</label>
    </div>
    <div class="option">
        <label></label>
        <input name="enabled" target="option.legend" type="checkbox" checked datatype="boolean" style="margin-top:6px;" >
        <label>Legend</label>
    </div>
</div>
<div class="custom">
    <div class="option">
        <label class="title">Theme</label>
    </div>
    <div class="option">
        <label>Line Width</label>
        <input name="lineWidth" target="theme.pie" type="number" min="0" max="2" value="1" datatype="number">
        <label>px</label>
    </div>
</div>
</body>
<script>
    $(function() {
        $(".custom").delegate("input", "change", function (event) {
            var input = $(event.currentTarget);
            var dataType = input.attr("datatype");
            var name = input.attr("name");
            var factor = parseFloat(input.attr("factor")) || 1;

            var value = input.val();
            if (dataType === "number") {
                value = parseInt(value, 10) * factor;
            }
            else if (dataType === "boolean") {
                value = event.currentTarget.checked;
            }

            var option = chart.getOptions();
            var theme = chart.getTheme();
            var options = {option: option, theme: theme};

            var path = input.attr("target").split(".");
            var obj = options;

            for (var i = 0; i < path.length; i++) {
                obj = obj[path[i]];
            }
            obj[name] = value;

            if (path[0] === "option") {
                chart.setOptions(options[path[0]]);
            }
            else {
                chart.setTheme(options[path[0]]);
            }
        });
    });
</script>
</html>
